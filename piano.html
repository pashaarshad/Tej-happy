<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CSS & JS Piano</title>
  <style>
    body {
      background: #222;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .piano {
      display: flex;
      border: 4px solid #444;
      border-radius: 12px;
      background: #333;
      box-shadow: 0 8px 32px #0008;
      padding: 20px 10px;
    }
    .key {
      width: 48px;
      height: 180px;
      margin: 0 2px;
      background: white;
      border: 1px solid #aaa;
      border-radius: 0 0 8px 8px;
      box-shadow: 0 2px 8px #0004;
      position: relative;
      cursor: pointer;
      transition: background 0.1s;
      z-index: 1;
      font-family: sans-serif;
      font-size: 14px;
      text-align: center;
      line-height: 180px;
      user-select: none;
    }
    .key:active, .key.playing {
      background: #ffd700;
    }
    .key.black {
      width: 32px;
      height: 110px;
      background: #222;
      color: #fff;
      border: 1px solid #444;
      position: absolute;
      left: 32px;
      top: 0;
      z-index: 2;
      margin: 0;
      line-height: 110px;
      border-radius: 0 0 6px 6px;
      box-shadow: 0 2px 12px #0008;
    }
    .key.black:active, .key.black.playing {
      background: #444;
    }
    .key-label {
      position: absolute;
      bottom: 8px;
      left: 0;
      width: 100%;
      font-size: 12px;
      color: #333;
      text-align: center;
      pointer-events: none;
    }
    .key.black .key-label {
      color: #fff;
    }
    .key-container {
      position: relative;
      display: inline-block;
    }
  </style>
</head>
<body>
  <div class="piano" id="piano"></div>
  <script>
    // Piano key data: [note, frequency, isBlack, leftOffset]
    const keys = [
      {note: 'C', freq: 261.63, black: false},
      {note: 'C#', freq: 277.18, black: true, offset: 32},
      {note: 'D', freq: 293.66, black: false},
      {note: 'D#', freq: 311.13, black: true, offset: 80},
      {note: 'E', freq: 329.63, black: false},
      {note: 'F', freq: 349.23, black: false},
      {note: 'F#', freq: 369.99, black: true, offset: 176},
      {note: 'G', freq: 392.00, black: false},
      {note: 'G#', freq: 415.30, black: true, offset: 224},
      {note: 'A', freq: 440.00, black: false},
      {note: 'A#', freq: 466.16, black: true, offset: 272},
      {note: 'B', freq: 493.88, black: false}
    ];

    const piano = document.getElementById('piano');
    // Create white keys
    keys.forEach((key, i) => {
      if (!key.black) {
        const container = document.createElement('div');
        container.className = 'key-container';
        const el = document.createElement('div');
        el.className = 'key';
        el.dataset.freq = key.freq;
        el.innerHTML = `<span class="key-label">${key.note}</span>`;
        container.appendChild(el);
        piano.appendChild(container);
      }
    });
    // Create black keys
    keys.forEach((key, i) => {
      if (key.black) {
        const el = document.createElement('div');
        el.className = 'key black';
        el.style.left = key.offset + 'px';
        el.dataset.freq = key.freq;
        el.innerHTML = `<span class="key-label">${key.note}</span>`;
        piano.appendChild(el);
      }
    });

    // Web Audio API setup
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playNote(frequency) {
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.type = 'sine';
      osc.frequency.value = frequency;
      gain.gain.value = 0.2;
      osc.connect(gain);
      gain.connect(audioCtx.destination);
      osc.start();
      setTimeout(() => {
        gain.gain.setTargetAtTime(0, audioCtx.currentTime, 0.05);
        osc.stop(audioCtx.currentTime + 0.1);
      }, 300);
    }

    // Key click handler
    piano.addEventListener('mousedown', e => {
      const key = e.target.closest('.key');
      if (key) {
        key.classList.add('playing');
        playNote(key.dataset.freq);
      }
    });
    piano.addEventListener('mouseup', e => {
      const key = e.target.closest('.key');
      if (key) key.classList.remove('playing');
    });
    piano.addEventListener('mouseleave', e => {
      document.querySelectorAll('.key.playing').forEach(k => k.classList.remove('playing'));
    });
  </script>
</body>
</html>
